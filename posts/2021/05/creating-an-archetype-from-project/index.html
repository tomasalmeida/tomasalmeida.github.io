<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Creating an archetype from an existing project | Tomás Dias Almeida notes</title><meta name=keywords content="maven,archetypes"><meta name=description content="If you are creating a cloud of microservices or are in an environment where you have to generate multiple maven projects or modules, it is very useful to create archetypes to handle these new modules/projects creation.
What is an archetype? A Maven archetype is a templated project. Maven offers several archetypes that allow you to create new maven modules ready to run in few seconds.
How to use a generic archetype?"><meta name=author content="Tomás Dias Almeida"><link rel=canonical href=https://tomasalmeida.pro/posts/2021/05/creating-an-archetype-from-project/><link crossorigin=anonymous href=/assets/css/stylesheet.41f2d211c00e636a3c229c52ef2d4299a66891ae66771098993b13bca7972ae6.css integrity="sha256-QfLSEcAOY2o8IpxS7y1CmaZoka5mdxCYmTsTvKeXKuY=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad();></script><link rel=icon href=https://tomasalmeida.pro/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://tomasalmeida.pro/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tomasalmeida.pro/favicon-32x32.png><link rel=apple-touch-icon href=https://tomasalmeida.pro/apple-touch-icon.png><link rel=mask-icon href=https://tomasalmeida.pro/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme: rgb(29, 30, 32);--entry: rgb(46, 46, 51);--primary: rgb(218, 218, 219);--secondary: rgb(155, 156, 157);--tertiary: rgb(65, 66, 68);--content: rgb(196, 196, 197);--hljs-bg: rgb(46, 46, 51);--code-bg: rgb(55, 56, 62);--border: rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Creating an archetype from an existing project"><meta property="og:description" content="If you are creating a cloud of microservices or are in an environment where you have to generate multiple maven projects or modules, it is very useful to create archetypes to handle these new modules/projects creation.
What is an archetype? A Maven archetype is a templated project. Maven offers several archetypes that allow you to create new maven modules ready to run in few seconds.
How to use a generic archetype?"><meta property="og:type" content="article"><meta property="og:url" content="https://tomasalmeida.pro/posts/2021/05/creating-an-archetype-from-project/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-05-29T15:13:31+02:00"><meta property="article:modified_time" content="2021-05-29T17:36:15+02:00"><meta property="og:site_name" content="Tomás Dias Almeida notes"><meta name=twitter:card content="summary"><meta name=twitter:title content="Creating an archetype from an existing project"><meta name=twitter:description content="If you are creating a cloud of microservices or are in an environment where you have to generate multiple maven projects or modules, it is very useful to create archetypes to handle these new modules/projects creation.
What is an archetype? A Maven archetype is a templated project. Maven offers several archetypes that allow you to create new maven modules ready to run in few seconds.
How to use a generic archetype?"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://tomasalmeida.pro/posts/"},{"@type":"ListItem","position":2,"name":"Creating an archetype from an existing project","item":"https://tomasalmeida.pro/posts/2021/05/creating-an-archetype-from-project/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Creating an archetype from an existing project","name":"Creating an archetype from an existing project","description":"If you are creating a cloud of microservices or are in an environment where you have to generate multiple maven projects or modules, it is very useful to create archetypes to handle these new modules/projects creation.\nWhat is an archetype? A Maven archetype is a templated project. Maven offers several archetypes that allow you to create new maven modules ready to run in few seconds.\nHow to use a generic archetype?","keywords":["maven","archetypes"],"articleBody":"If you are creating a cloud of microservices or are in an environment where you have to generate multiple maven projects or modules, it is very useful to create archetypes to handle these new modules/projects creation.\nWhat is an archetype? A Maven archetype is a templated project. Maven offers several archetypes that allow you to create new maven modules ready to run in few seconds.\nHow to use a generic archetype? Archetype usage is quite simple. If you want to generate an archetype based on the default list, just run:\nmvn archetype:generate And then choose one of the options, provide the details and confirm. The new project will be already created.\nHow to use a custom archetype? In this case, we need to specify the groupId and artifactId of the archetype to be able to use a custom one. As an example, let’s see the archetype provided by Adobe for AEM:\nmvn archetype:generate \\ -DarchetypeGroupId=com.adobe.aem \\ -D archetypeArtifactId=aem-project-archetype \\ -D archetypeVersion=27 If you run the command, you will be asked about some properties of your project. Some properties are standard (groupId, version, artifactId and package), but others were specific of this artifact, like appTitle or sdkVersion. These properties will help the archetype to generate a new project for you and in few seconds and knowing nothing about Adobe AEM you have your new project ready to run.\nHow does the archetype work? Internally, an archetype has all the files (pom file, classes, readme, etc…) with variables that will be replaced during project generation. As an example, you can see these variables in several parts of the pom file below.\n xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\" 4.0.0  ${groupId} ${rootArtifactId} ${version} ../pom.xml  ${artifactId} ${appTitle} - Core Core bundle for ${appTitle} ... Example extracted from Github adobe/aem-project-archetype project\nMaven has a good documentation how to organize and create your archetype from scratch.\nCreating an archetype from a project In most cases, it is hard to maintain an archetype because:\n It is not a project itself, so you need to use your archetype to see if the generated project is working. Templating is good, but it is hard to read and you need to “imagine” how the code will look like after. We are lazy, and if it is hard to understand, it will be hard to maintain. People will go back to copy-paste projects and replace the text.  A simple way to bypass all these constraints is to create an archetype from an example project. Our example project is a perfect compilable project with all desired configurations we want to keep together in the clones.\nCreate your archetype example project Some characteristics are desired in the archetype example project:\n It should be simple, but complete. Remember to include all dependencies and one example of each element of your project. For example, if the project is a microservice, it makes sense to include a controller, a service, and a repository. Name it in a coherent manner (you will see it in the next steps). I would recommend, for example, having a controller called ArchetypeExampleController which talks to ArchetypeExampleService. In each file, place the same prefix in the variables, so it will be easy to replace them. For example, if you need a variable for your ArchetypeExampleService, a good name is archetypeVariableService. Include the dotfiles as part of this project and a good readme.  archetype:create-from-project The maven goal archetype:create-from-project is the key to generate an archetype from a project.\nAs part of the configuration, you can pass an archetype.properties file as a parameter. This property file should like that:\n# these are standard properties package=com.almeida.tomas groupId=archetype.it artifactId=basic version=1.0.0-SNAPSHOT # here we add our personalized properties defaultClassPrefix=ArchetypeExample defaultVariablePrefix=archetypeVariable As you see above, I only included the changing part of the files or variables and maven will take care of replacing them for me.\nStep-by-step Let’s go through all the steps from our archetype example project until our archetype.\n1. Rename all dotfiles It was a known issue that dotfiles are not included in the archetype. So we need to rename them, so they will be also included in the generated archetype (and posterior project).\nmv .gitignore dot.gitignore mv .file dot.file 2. Call the maven goal with the desired parameters. mvn -U clean archetype:create-from-project \\  -Dinteractive=false \\  -DkeepParent=true \\  -DpropertyFile=archetype.properties \\  -DpackageName=com.almeida.tomas \\  -Darchetype.filteredExtensions=java,xml,md In the documentation, you can see more parameters and why and when they are used, but in summary:\n -Dinteractive=false: interactive mode is disabled. -DkeepParent=true: keep the parent. -DpropertyFile=archetype.properties: use our archetype.properties file to check for the variables. -DpackageName=com.almeida.tomas: the package name for java sources that should be included in the archetype. -Darchetype.filteredExtensions=java,xml,md: files with the selected extensions will be checked and the content and the name of the files will be changed by the variables.  3. Clean up the generated archetype metadata In some cases, the generation includes a default value of a property and we want to be sure that all values will be filled by the user.\ncd target/generated-sources/archetype/ sed -i 's/.*defaultValue.*//g' src/main/resources/META-INF/maven/archetype-metadata.xml 4. Install or deploy the archetype If you are running these commands locally install, the archetype in your local repo:\n# be sure to be in the target/generated-sources/archetype folder mvn -B -U clean install My recommendation is to configure a Jenkins job, so every time a change is pushed to the project, Jenkins runs the commands and pushes a new version to your repository.\n# deploy the archetype to repository mvn -B -U clean deploy Use your created archetype The created archetype will have the same artifactId with a -archetype suffix. So based on our example:\nmvn archetype:generate \\  -DarchetypeGroupId=tomas.examples \\  -DarchetypeArtifactId=archetypeProject-archetype \\  -DarchetypeVersion=1.0.0-SNAPSHOT Now, we will be asked to provide a value to the default and personalized variables:\nDefine value for property 'groupId': com.tomas.almeida Define value for property 'artifactId': demo-project Define value for property 'version' 1.0-SNAPSHOT: 1.0.0-SNAPSHOT Define value for property 'package' com.tomas.almeida: com.tomas.almeida.domain Define value for property 'defaultClassPrefix': Demo Define value for property 'defaultVariablePrefix': demo Confirm the values you have entered are correct:\nConfirm properties configuration: groupId: com.tomas.almeida artifactId: demo-project version: 1.0.0-SNAPSHOT package: com.tomas.almeida.domain defaultClassPrefix: Demo defaultVariablePrefix: demo Y: : Y A new folder will be created and the name is the artifacId name. In our example, demo-project.\ncd demo-project The dotfiles need to be renamed:\nmv dot.gitignore .gitignore mv dot.file .file So, you can now create several clones of your archetype example project in minutes!\n If you found any error or want to help me to improve this article, please comment the pull request.\n","wordCount":"1080","inLanguage":"en","datePublished":"2021-05-29T15:13:31+02:00","dateModified":"2021-05-29T17:36:15+02:00","author":{"@type":"Person","name":"Tomás Dias Almeida"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://tomasalmeida.pro/posts/2021/05/creating-an-archetype-from-project/"},"publisher":{"@type":"Organization","name":"Tomás Dias Almeida notes","logo":{"@type":"ImageObject","url":"https://tomasalmeida.pro/favicon.ico"}}}</script></head><body id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><header class=header><nav class=nav><div class=logo><a href=https://tomasalmeida.pro/ accesskey=h title="Tomás Dias Almeida (Alt + H)">Tomás Dias Almeida</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://tomasalmeida.pro/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://tomasalmeida.pro/archive/ title=Archive><span>Archive</span></a></li><li><a href=https://tomasalmeida.pro/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Creating an archetype from an existing project</h1><div class=post-meta><span title="2021-05-29 15:13:31 +0200 +0200">May 29, 2021</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Tomás Dias Almeida</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#what-is-an-archetype aria-label="What is an archetype?">What is an archetype?</a></li><li><a href=#how-to-use-a-generic-archetype aria-label="How to use a generic archetype?">How to use a generic archetype?</a></li><li><a href=#how-to-use-a-custom-archetype aria-label="How to use a custom archetype?">How to use a custom archetype?</a></li><li><a href=#how-does-the-archetype-work aria-label="How does the archetype work?">How does the archetype work?</a></li><li><a href=#creating-an-archetype-from-a-project aria-label="Creating an archetype from a project">Creating an archetype from a project</a><ul><li><a href=#create-your-archetype-example-project aria-label="Create your archetype example project">Create your archetype example project</a></li><li><a href=#archetypecreate-from-project aria-label=archetype:create-from-project>archetype:create-from-project</a></li><li><a href=#step-by-step aria-label=Step-by-step>Step-by-step</a><ul><li><a href=#1-rename-all-dotfiles aria-label="1. Rename all dotfiles">1. Rename all dotfiles</a></li><li><a href=#2-call-the-maven-goal-with-the-desired-parameters aria-label="2. Call the maven goal with the desired parameters.">2. Call the maven goal with the desired parameters.</a></li><li><a href=#3-clean-up-the-generated-archetype-metadata aria-label="3. Clean up the generated archetype metadata">3. Clean up the generated archetype metadata</a></li><li><a href=#4-install-or-deploy-the-archetype aria-label="4. Install or deploy the archetype">4. Install or deploy the archetype</a></li></ul></li></ul></li><li><a href=#use-your-created-archetype aria-label="Use your created archetype">Use your created archetype</a></li></ul></div></details></div><div class=post-content><p>If you are creating a cloud of microservices or are in an environment where you have to generate multiple maven projects or modules, it is very useful to create archetypes to handle these new modules/projects creation.</p><h2 id=what-is-an-archetype>What is an archetype?<a hidden class=anchor aria-hidden=true href=#what-is-an-archetype>#</a></h2><p><a href=https://maven.apache.org/guides/introduction/introduction-to-archetypes.html>A Maven archetype</a> is a templated project. Maven offers several archetypes that allow you to create new maven modules ready to run in few seconds.</p><h2 id=how-to-use-a-generic-archetype>How to use a generic archetype?<a hidden class=anchor aria-hidden=true href=#how-to-use-a-generic-archetype>#</a></h2><p><a href=https://maven.apache.org/archetype/maven-archetype-plugin/usage.html>Archetype usage</a> is quite simple. If you want to generate an archetype based on the default list, just run:</p><pre><code>mvn archetype:generate
</code></pre><p>And then choose one of the options, provide the details and confirm. The new project will be already created.</p><h2 id=how-to-use-a-custom-archetype>How to use a custom archetype?<a hidden class=anchor aria-hidden=true href=#how-to-use-a-custom-archetype>#</a></h2><p>In this case, we need to specify the groupId and artifactId of the archetype to be able to use a custom one. As an example, let&rsquo;s see the <a href=https://github.com/adobe/aem-project-archetype>archetype provided by Adobe for AEM</a>:</p><pre><code>mvn archetype:generate  \
     -DarchetypeGroupId=com.adobe.aem \
     -D archetypeArtifactId=aem-project-archetype \
     -D archetypeVersion=27
</code></pre><p>If you run the command, you will be asked about some properties of your project. Some properties are standard (<code>groupId</code>, <code>version</code>, <code>artifactId</code> and <code>package</code>), but others were specific of this artifact, like <code>appTitle</code> or <code>sdkVersion</code>. These properties will help the archetype to generate a new project for you and in few seconds and knowing nothing about Adobe AEM you have your new project ready to run.</p><h2 id=how-does-the-archetype-work>How does the archetype work?<a hidden class=anchor aria-hidden=true href=#how-does-the-archetype-work>#</a></h2><p>Internally, an archetype has all the files (pom file, classes, readme, etc&mldr;) with variables that will be replaced during project generation. As an example, you can see these variables in several parts of the pom file below.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml>
<span style=color:#f92672>&lt;project</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;http://maven.apache.org/POM/4.0.0&#34;</span> <span style=color:#a6e22e>xmlns:xsi=</span><span style=color:#e6db74>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
    <span style=color:#a6e22e>xsi:schemaLocation=</span><span style=color:#e6db74>&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span style=color:#f92672>&gt;</span>
    <span style=color:#f92672>&lt;modelVersion&gt;</span>4.0.0<span style=color:#f92672>&lt;/modelVersion&gt;</span>
    <span style=color:#f92672>&lt;parent&gt;</span>
        <span style=color:#f92672>&lt;groupId&gt;</span>${groupId}<span style=color:#f92672>&lt;/groupId&gt;</span>
        <span style=color:#f92672>&lt;artifactId&gt;</span>${rootArtifactId}<span style=color:#f92672>&lt;/artifactId&gt;</span>
        <span style=color:#f92672>&lt;version&gt;</span>${version}<span style=color:#f92672>&lt;/version&gt;</span>
        <span style=color:#f92672>&lt;relativePath&gt;</span>../pom.xml<span style=color:#f92672>&lt;/relativePath&gt;</span>
    <span style=color:#f92672>&lt;/parent&gt;</span>
    <span style=color:#f92672>&lt;artifactId&gt;</span>${artifactId}<span style=color:#f92672>&lt;/artifactId&gt;</span>
    <span style=color:#f92672>&lt;name&gt;</span>${appTitle} - Core<span style=color:#f92672>&lt;/name&gt;</span>
    <span style=color:#f92672>&lt;description&gt;</span>Core bundle for ${appTitle}<span style=color:#f92672>&lt;/description&gt;</span>
...
</code></pre></div><p>Example extracted from <a href=https://github.com/adobe/aem-project-archetype/blob/71d3bbcba7ec37897910ca8042b61004f0963c34/src/main/archetype/core/pom.xml#L17-L28>Github adobe/aem-project-archetype project</a></p><p>Maven has a <a href=https://maven.apache.org/guides/mini/guide-creating-archetypes.html>good documentation how to organize and create your archetype</a> from scratch.</p><h2 id=creating-an-archetype-from-a-project>Creating an archetype from a project<a hidden class=anchor aria-hidden=true href=#creating-an-archetype-from-a-project>#</a></h2><p>In most cases, it is hard to maintain an archetype because:</p><ol><li>It is not a project itself, so you need to use your archetype to see if the generated project is working.</li><li>Templating is good, but it is hard to read and you need to &ldquo;imagine&rdquo; how the code will look like after.</li><li>We are lazy, and if it is hard to understand, it will be hard to maintain. People will go back to copy-paste projects and replace the text.</li></ol><p>A simple way to bypass all these constraints is to create an archetype from an example project. Our example project is a perfect compilable project with all desired configurations we want to keep together in the clones.</p><h3 id=create-your-archetype-example-project>Create your archetype example project<a hidden class=anchor aria-hidden=true href=#create-your-archetype-example-project>#</a></h3><p>Some characteristics are desired in the archetype example project:</p><ol><li>It should be simple, but complete. Remember to include all dependencies and one example of each element of your project. For example, if the project is a microservice, it makes sense to include a controller, a service, and a repository.</li><li>Name it in a coherent manner (you will see it in the next steps). I would recommend, for example, having a controller called <code>ArchetypeExampleController</code> which talks to <code>ArchetypeExampleService</code>.</li><li>In each file, place the same prefix in the variables, so it will be easy to replace them. For example, if you need a variable for your <code>ArchetypeExampleService</code>, a good name is <code>archetypeVariableService</code>.</li><li>Include the dotfiles as part of this project and a good readme.</li></ol><h3 id=archetypecreate-from-project>archetype:create-from-project<a hidden class=anchor aria-hidden=true href=#archetypecreate-from-project>#</a></h3><p>The maven goal <a href=https://maven.apache.org/archetype/maven-archetype-plugin/create-from-project-mojo.html>archetype:create-from-project</a> is the key to generate an archetype from a project.</p><p>As part of the configuration, you can pass an archetype.properties file as a parameter. This property file should like that:</p><pre><code class=language-properties data-lang=properties># these are standard properties
package=com.almeida.tomas
groupId=archetype.it
artifactId=basic
version=1.0.0-SNAPSHOT

# here we add our personalized properties
defaultClassPrefix=ArchetypeExample
defaultVariablePrefix=archetypeVariable
</code></pre><p>As you see above, I only included the changing part of the files or variables and maven will take care of replacing them for me.</p><h3 id=step-by-step>Step-by-step<a hidden class=anchor aria-hidden=true href=#step-by-step>#</a></h3><p>Let&rsquo;s go through all the steps from our archetype example project until our archetype.</p><h4 id=1-rename-all-dotfiles>1. Rename all dotfiles<a hidden class=anchor aria-hidden=true href=#1-rename-all-dotfiles>#</a></h4><p>It was a known issue that dotfiles are not included in the archetype. So we need to rename them, so they will be also included in the generated archetype (and posterior project).</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>mv .gitignore dot.gitignore
mv .file dot.file
</code></pre></div><h4 id=2-call-the-maven-goal-with-the-desired-parameters>2. Call the maven goal with the desired parameters.<a hidden class=anchor aria-hidden=true href=#2-call-the-maven-goal-with-the-desired-parameters>#</a></h4><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>mvn -U clean archetype:create-from-project <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>      -Dinteractive<span style=color:#f92672>=</span>false <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>      -DkeepParent<span style=color:#f92672>=</span>true <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>      -DpropertyFile<span style=color:#f92672>=</span>archetype.properties <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>      -DpackageName<span style=color:#f92672>=</span>com.almeida.tomas <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>      -Darchetype.filteredExtensions<span style=color:#f92672>=</span>java,xml,md
</code></pre></div><p>In the <a href=https://maven.apache.org/archetype/maven-archetype-plugin/create-from-project-mojo.html>documentation</a>, you can see more parameters and why and when they are used, but in summary:</p><ul><li><code>-Dinteractive=false</code>: interactive mode is disabled.</li><li><code>-DkeepParent=true</code>: keep the parent.</li><li><code>-DpropertyFile=archetype.properties</code>: use our archetype.properties file to check for the variables.</li><li><code>-DpackageName=com.almeida.tomas</code>: the package name for java sources that should be included in the archetype.</li><li><code>-Darchetype.filteredExtensions=java,xml,md</code>: files with the selected extensions will be checked and the content and the name of the files will be changed by the variables.</li></ul><h4 id=3-clean-up-the-generated-archetype-metadata>3. Clean up the generated archetype metadata<a hidden class=anchor aria-hidden=true href=#3-clean-up-the-generated-archetype-metadata>#</a></h4><p>In some cases, the generation includes a default value of a property and we want to be sure that all values will be filled by the user.</p><pre><code class=language-shel data-lang=shel>cd target/generated-sources/archetype/
sed -i 's/.*defaultValue.*//g' src/main/resources/META-INF/maven/archetype-metadata.xml 
</code></pre><h4 id=4-install-or-deploy-the-archetype>4. Install or deploy the archetype<a hidden class=anchor aria-hidden=true href=#4-install-or-deploy-the-archetype>#</a></h4><p>If you are running these commands locally install, the archetype in your local repo:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># be sure to be in the target/generated-sources/archetype folder</span>
mvn -B -U clean install
</code></pre></div><p>My recommendation is to configure a Jenkins job, so every time a change is pushed to the project, Jenkins runs the commands and pushes a new version to your repository.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># deploy the archetype to repository</span>
mvn -B -U clean deploy
</code></pre></div><h2 id=use-your-created-archetype>Use your created archetype<a hidden class=anchor aria-hidden=true href=#use-your-created-archetype>#</a></h2><p>The created archetype will have the same artifactId with a <code>-archetype</code> suffix. So based on our example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>mvn archetype:generate <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>     -DarchetypeGroupId<span style=color:#f92672>=</span>tomas.examples <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>     -DarchetypeArtifactId<span style=color:#f92672>=</span>archetypeProject-archetype <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>     -DarchetypeVersion<span style=color:#f92672>=</span>1.0.0-SNAPSHOT
</code></pre></div><p>Now, we will be asked to provide a value to the default and personalized variables:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>Define value <span style=color:#66d9ef>for</span> property <span style=color:#e6db74>&#39;groupId&#39;</span>: com.tomas.almeida
Define value <span style=color:#66d9ef>for</span> property <span style=color:#e6db74>&#39;artifactId&#39;</span>: demo-project
Define value <span style=color:#66d9ef>for</span> property <span style=color:#e6db74>&#39;version&#39;</span> 1.0-SNAPSHOT: 1.0.0-SNAPSHOT
Define value <span style=color:#66d9ef>for</span> property <span style=color:#e6db74>&#39;package&#39;</span> com.tomas.almeida: com.tomas.almeida.domain 
Define value <span style=color:#66d9ef>for</span> property <span style=color:#e6db74>&#39;defaultClassPrefix&#39;</span>: Demo 
Define value <span style=color:#66d9ef>for</span> property <span style=color:#e6db74>&#39;defaultVariablePrefix&#39;</span>: demo

</code></pre></div><p>Confirm the values you have entered are correct:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>Confirm properties configuration:
groupId: com.tomas.almeida
artifactId: demo-project
version: 1.0.0-SNAPSHOT
package: com.tomas.almeida.domain 
defaultClassPrefix: Demo
defaultVariablePrefix: demo
 Y: : Y
</code></pre></div><p>A new folder will be created and the name is the artifacId name. In our example, <code>demo-project</code>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cd demo-project
</code></pre></div><p>The dotfiles need to be renamed:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>mv dot.gitignore .gitignore
mv dot.file .file
</code></pre></div><p>So, you can now create several clones of your archetype example project in minutes!</p><hr><p>If you found any error or want to help me to improve this article, please <a href=https://github.com/tomasalmeida/tomasalmeida.github.io/pull/5>comment the pull request</a>.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://tomasalmeida.pro/tags/maven/>maven</a></li><li><a href=https://tomasalmeida.pro/tags/archetypes/>archetypes</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Creating an archetype from an existing project on twitter" href="https://twitter.com/intent/tweet/?text=Creating%20an%20archetype%20from%20an%20existing%20project&url=https%3a%2f%2ftomasalmeida.pro%2fposts%2f2021%2f05%2fcreating-an-archetype-from-project%2f&hashtags=maven%2carchetypes"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zm-253.927 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Creating an archetype from an existing project on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ftomasalmeida.pro%2fposts%2f2021%2f05%2fcreating-an-archetype-from-project%2f&title=Creating%20an%20archetype%20from%20an%20existing%20project&summary=Creating%20an%20archetype%20from%20an%20existing%20project&source=https%3a%2f%2ftomasalmeida.pro%2fposts%2f2021%2f05%2fcreating-an-archetype-from-project%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0v-129.439c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02v-126.056c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768h75.024zm-307.552-334.556c-25.674.0-42.448 16.879-42.448 39.002.0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Creating an archetype from an existing project on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ftomasalmeida.pro%2fposts%2f2021%2f05%2fcreating-an-archetype-from-project%2f&title=Creating%20an%20archetype%20from%20an%20existing%20project"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zm-119.474 108.193c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zm-160.386-29.702c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Creating an archetype from an existing project on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ftomasalmeida.pro%2fposts%2f2021%2f05%2fcreating-an-archetype-from-project%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978v-192.915h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Creating an archetype from an existing project on whatsapp" href="https://api.whatsapp.com/send?text=Creating%20an%20archetype%20from%20an%20existing%20project%20-%20https%3a%2f%2ftomasalmeida.pro%2fposts%2f2021%2f05%2fcreating-an-archetype-from-project%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23-13.314-11.876-22.304-26.542-24.916-31.026s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Creating an archetype from an existing project on telegram" href="https://telegram.me/share/url?text=Creating%20an%20archetype%20from%20an%20existing%20project&url=https%3a%2f%2ftomasalmeida.pro%2fposts%2f2021%2f05%2fcreating-an-archetype-from-project%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47A3.38 3.38.0 0126.49 29.86zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://tomasalmeida.pro/>Tomás Dias Almeida notes</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById('menu')
if(menu){menu.scrollLeft=localStorage.getItem("menu-scroll-position");menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft);}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.pushState(null,null,`#${id}`);}});});</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script><script>document.querySelectorAll('pre > code').forEach((codeblock)=>{const container=codeblock.parentNode.parentNode;const copybutton=document.createElement('button');copybutton.classList.add('copy-code');copybutton.innerHTML='copy';function copyingDone(){copybutton.innerHTML='copied!';setTimeout(()=>{copybutton.innerHTML='copy';},2000);}
copybutton.addEventListener('click',(cb)=>{if('clipboard'in navigator){navigator.clipboard.writeText(codeblock.textContent);copyingDone();return;}
const range=document.createRange();range.selectNodeContents(codeblock);const selection=window.getSelection();selection.removeAllRanges();selection.addRange(range);try{document.execCommand('copy');copyingDone();}catch(e){};selection.removeRange(range);});if(container.classList.contains("highlight")){container.appendChild(copybutton);}else if(container.parentNode.firstChild==container){}else if(codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"){codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);}else{codeblock.parentNode.appendChild(copybutton);}});</script></body></html>